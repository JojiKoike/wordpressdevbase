---
- name: Install ius repository for Install Latest Apache2
  become: yes
  yum:
    name: "{{ ius_repository }}"
    state: present

- name: Disabled ius repository
  become: yes
  replace:
    path: /etc/yum.repos.d/ius.repo
    regexp: 'enabled *= *1'
    replace: 'enabled=0'

- name: Install HTTP/2 core engine
  become: yes
  yum:
    enablerepo: epel
    name: nghttp2
    state: present

- name: Install Required packages
  become: yes
  yum:
    name: "{{ item.name }}"
    state: present
  with_items:
    - name: mailcap
    - name: libdb-devel
    - name: expat-devel
    - name: openldap-devel

- name: Install Latest Apache2
  become: yes
  yum:
    enablerepo: ius
    disablerepo: base,extras,updates
    name: "{{ item.name }}"
    state: present
  with_items:
    - name: httpd
    - name: httpd-devel

- name: Start And Eneble httpd
  become: yes
  service:
    name: httpd
    state: started
    enabled: yes

- name: Configure httpd.conf
  become: yes
  template:
    src: httpd.conf.j2
    dest: /etc/httpd/conf/httpd.conf
  notify: restart apache2
